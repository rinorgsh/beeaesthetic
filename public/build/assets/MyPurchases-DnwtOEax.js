import{r as u,c as a,b as o,f as _,d as s,h,g,u as y,P as k,F as x,e as D,i as v,t as d,y as b}from"./app-CGx5xUBW.js";import{T,F as V}from"./Footer-VL4nrpqU.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css            */const N={class:"purchases-section"},P={class:"container"},C={key:0,class:"empty-state"},B={key:1,class:"purchases-grid"},E=["src","alt"],L={class:"purchase-info"},M={class:"purchase-date"},S={class:"purchase-price"},A={class:"download-section"},$={class:"download-count"},q=["onClick","disabled"],z={key:0},G={key:1},I={key:2},R={key:0,class:"error-message"},U={key:1,class:"success-message"},j={__name:"MyPurchases",props:{purchases:{type:Array,required:!0}},setup(p){const l=u(!1),c=u(""),i=u(""),m=n=>!(n.download_count>=n.max_downloads||n.expires_at&&new Date(n.expires_at)<new Date),w=n=>new Date(n).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"}),f=async n=>{var t,e;l.value=!0,c.value="",i.value="";try{const r=await b.get(`/products/${n}/download`);r.data.success&&r.data.download_url&&(window.open(r.data.download_url,"_blank"),i.value=r.data.message,setTimeout(()=>{window.location.reload()},2e3))}catch(r){console.error("Erreur de t√©l√©chargement:",r),c.value=((e=(t=r.response)==null?void 0:t.data)==null?void 0:e.error)||"Une erreur est survenue lors du t√©l√©chargement."}finally{l.value=!1}};return(n,t)=>(o(),a("div",null,[_(T),s("section",N,[s("div",P,[t[2]||(t[2]=s("h1",{class:"page-title"},"Mes achats",-1)),t[3]||(t[3]=s("div",{class:"page-divider"},null,-1)),p.purchases.length===0?(o(),a("div",C,[t[1]||(t[1]=s("p",null,"Vous n'avez pas encore achet√© de produits.",-1)),_(y(k),{href:"/products",class:"btn-primary"},{default:h(()=>t[0]||(t[0]=[g("Voir les produits")])),_:1})])):(o(),a("div",B,[(o(!0),a(x,null,D(p.purchases,e=>(o(),a("div",{key:e.id,class:"purchase-card"},[s("img",{src:e.product.image_url,alt:e.product.name,class:"product-image"},null,8,E),s("div",L,[s("h3",null,d(e.product.name),1),s("p",M,"Achet√© le "+d(w(e.created_at)),1),s("p",S,d(e.amount)+" ‚Ç¨",1),s("div",A,[s("p",$," T√©l√©chargements : "+d(e.download_count)+" / "+d(e.max_downloads),1),s("button",{onClick:r=>f(e.product.id),disabled:!m(e)||l.value,class:"btn-download"},[l.value?(o(),a("span",z,"‚è≥ G√©n√©ration du lien...")):m(e)?(o(),a("span",I,"üì• T√©l√©charger")):(o(),a("span",G,"‚ùå Limite atteinte"))],8,q)]),c.value?(o(),a("p",R,d(c.value),1)):v("",!0),i.value?(o(),a("p",U,d(i.value),1)):v("",!0)])]))),128))]))])]),_(V)]))}},Q=F(j,[["__scopeId","data-v-0d9c81a7"]]);export{Q as default};
